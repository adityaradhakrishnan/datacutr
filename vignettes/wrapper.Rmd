---
title: "Wrapped Approach"
output: 
  rmarkdown::html_vignette
    
vignette: >
  %\VignetteIndexEntry{Wrapped Approach}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

This article describes how to cut study SDTM data using the wrapper function within the datacutr package. Please note that,
this wrapped approach may not be suitable if you wish to enable any further study or project specific customization.

# Programming Flow

* [Read in Data](#readdata)
* [Create DCUT Dataset](#dcut)
* [Preprocess Datasets](#preprocess)
* [Process data cut](#processcut)
* [Output Final List of Cut Datasets](#output)

## Read in Data {#readdata}

To start, all SDTM data to be cut needs to be read into the environment. These should be stored in a list.

```{r, message=FALSE, warning=FALSE}
library(datacutr)
library(admiraldev)
library(dplyr)
library(lubridate)
library(stringr)
library(purrr)

source(here::here('inst/templates/dummy_data.R'))
source_data <- list(ds=ds, dm=dm, ae=ae, sc=sc, lb=lb, fa=fa, ts=ts)
```

## Create DCUT Dataset {#dcut}

The next step is to create the DCUT dataset containing the datacut date and description.

```{r, message=FALSE, warning=FALSE}
dcut <- create_dcut(dataset_ds = ds,
                    ds_date_var = DSSTDTC,
                    filter = DSDECOD == "RANDOMIZATION",
                    cut_date = "2022-06-04",
                    cut_description = "Clinical Cutoff Date")
```

```{r, eval=TRUE, echo=FALSE}
dataset_vignette(
  dcut,
  display_vars = vars(USUBJID, DCUTDTC, DCUTDTM, DCUTDESC)
)
```

## Preprocess Datasets {#preprocess}

If any pre-processing of datasets is needed, for example in the case of FA, where there are multiple date variables, this should be done next.

```{r, message=FALSE, warning=FALSE}
source_data$fa <- source_data$fa %>%
  mutate(DCUT_TEMP_FAXDTC = case_when(
    FASTDTC!="" ~ FASTDTC,
    FADTC!=""   ~ FADTC,
    TRUE        ~ as.character(NA)
  ))
```

## Process data cut {#processcut}

## Output Final List of Cut Datasets {#output}
